{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { pictureValidator } from 'src/shared/picture-format.directive';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/services/auth.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../services/buddy.service\";\nimport * as i5 from \"src/services/image.service\";\nimport * as i6 from \"src/services/displaying-elements.service\";\nimport * as i7 from \"@angular/common\";\n\nfunction EditProfileComponent_h2_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"CREATION DU PROFIL\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_h2_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"EDITION DU PROFIL\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_label_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 40);\n    i0.ɵɵtext(1, \"Nouveau mot de passe\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_input_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"input\", 41);\n  }\n}\n\nfunction EditProfileComponent_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Photo de profil:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 42);\n    i0.ɵɵlistener(\"change\", function EditProfileComponent_div_42_Template_input_change_3_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.selectFile($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"img\", 43);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", ctx_r4.previewProfilePic, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction EditProfileComponent_option_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 44);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const instrument_r10 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", instrument_r10);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", instrument_r10, \" \");\n  }\n}\n\nfunction EditProfileComponent_input_89_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"input\", 45);\n    i0.ɵɵlistener(\"click\", function EditProfileComponent_input_89_Template_input_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.onSubmitProfileForm();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_input_90_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"input\", 46);\n    i0.ɵɵlistener(\"click\", function EditProfileComponent_input_90_Template_input_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.onSubmitModifProfileForm();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let EditProfileComponent = /*#__PURE__*/(() => {\n  class EditProfileComponent {\n    // genericPattern: string = '^[^<].*[^>]$';\n    // passwordPattern: string =\n    //   '^[^<>](?=.{8,}$)(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*\\\\W).*[^<>]$';\n    constructor(router, authService, formBuilder, buddyService, imageservice, displayingElementsService) {\n      this.router = router;\n      this.authService = authService;\n      this.formBuilder = formBuilder;\n      this.buddyService = buddyService;\n      this.imageservice = imageservice;\n      this.displayingElementsService = displayingElementsService; // controlsFormList: string[] = [\n      //   'login',\n      //   'password',\n      //   'mailAddress',\n      //   'firstName',\n      //   'lastName',\n      //   'birthDate',\n      //   'location',\n      //   'gender',\n      //   'instrument',\n      //   'singer',\n      //   'pro',\n      //   'bio',\n      //   'profilePicture',\n      //   'bannerPicture',\n      // ];\n\n      this.instrumentsList = ['Aucun', 'Guitare', 'Basse', 'Ukulélé', 'Batterie', 'Cajun', 'Trompette', 'Synthé', 'piano', 'Flûte traversière'];\n    }\n\n    ngOnInit() {\n      this.displayingElementsService.displayingProfileCreationMode.subscribe(updateClassCrea => {\n        this.displayCreationMode = updateClassCrea;\n      });\n      console.log('displayCreationMode : ', this.displayCreationMode);\n      this.userProfileForm = this.formBuilder.group({\n        login: [null, {\n          validators: [// Validators.required, Validators.minLength(3)\n          ]\n        }],\n        password: ['', {\n          validators: [Validators.required // Validators.pattern(this.authService.passwordPattern),\n          ]\n        }],\n        passwordModif: ['' // {\n        //   validators: [Validators.pattern(this.authService.passwordPattern)],\n        // },\n        ],\n        mailAddress: ['', {\n          validators: [// Validators.required, Validators.email\n          ]\n        }],\n        firstName: [null, {\n          validators: [// Validators.required\n          ]\n        }],\n        lastName: [null, {\n          validators: [// Validators.required\n          ]\n        }],\n        birthDate: ['', {\n          validators: [// Validators.required,\n            // ageValidator(this.authService.minimumAge),\n          ]\n        }],\n        location: [null, {\n          validators: [// Validators.required\n          ]\n        }],\n        gender: [null // Validators.required\n        ],\n        instrument: [null //  Validators.required\n        ],\n        singer: [null // Validators.required\n        ],\n        pro: [null //  Validators.required\n        ],\n        bio: [null],\n        profilePicture: [null, pictureValidator(this.authService.pictureExtension)],\n        bannerPicture: [null]\n      });\n      console.log('this.displayCreationMode : ', this.displayCreationMode);\n\n      if (!this.displayCreationMode) {\n        this.formFilling();\n      }\n    }\n\n    formFilling() {\n      this.buddyService // .getBuddyByID(this.authService.getMyId())\n      .getMyInformations().subscribe(value => {\n        console.log('je suis : ', value);\n        this.userProfileForm.controls['login'].setValue(value['login']);\n        this.userProfileForm.controls['mailAddress'].setValue(value['mailAddress']);\n        this.userProfileForm.controls['firstName'].setValue(value['firstName']);\n        this.userProfileForm.controls['lastName'].setValue(value['lastName']);\n        this.userProfileForm.controls['birthDate'].setValue(value['birthDate']);\n        this.userProfileForm.controls['location'].setValue(value['location']);\n        this.userProfileForm.controls['gender'].setValue(value['gender']);\n        this.userProfileForm.controls['instrument'].setValue(value['instrument']);\n        this.userProfileForm.controls['singer'].setValue(value['singer']);\n        this.userProfileForm.controls['pro'].setValue(value['pro']);\n        this.userProfileForm.controls['bio'].setValue(value['bio']);\n      });\n    }\n\n    selectFile(event) {\n      const file = event.target.files[0];\n      this.imageservice.getBase64(file).subscribe(str => {\n        this.previewProfilePic = str;\n      });\n    }\n\n    onSubmitProfileForm() {\n      this.userProfileForm.value.profilePicture = this.previewProfilePic;\n      console.log('soumission du formulaire: ', this.userProfileForm);\n      this.authService.authUser(this.userProfileForm, '/register');\n    }\n\n    onSubmitModifProfileForm() {\n      if (this.userProfileForm.value.password === '') {\n        delete this.userProfileForm.value.password;\n      }\n\n      console.log('modification du formulaire: ', this.userProfileForm);\n      this.authService.updatehUser(this.userProfileForm, '/updateprofile');\n    }\n\n  }\n\n  EditProfileComponent.ɵfac = function EditProfileComponent_Factory(t) {\n    return new (t || EditProfileComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.BuddyService), i0.ɵɵdirectiveInject(i5.ImageService), i0.ɵɵdirectiveInject(i6.DisplayingElementsService));\n  };\n\n  EditProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditProfileComponent,\n    selectors: [[\"app-edit-profile\"]],\n    decls: 91,\n    vars: 9,\n    consts: [[1, \"form-card\"], [4, \"ngIf\"], [3, \"formGroup\"], [\"for\", \"login\"], [\"type\", \"text\", \"id\", \"loginInput\", \"formControlName\", \"login\"], [\"for\", \"password\"], [\"type\", \"text\", \"id\", \"passwordInput\", \"formControlName\", \"password\"], [\"for\", \"passwordModif\", 4, \"ngIf\"], [\"type\", \"text\", \"id\", \"passwordModifInput\", \"formControlName\", \"passwordModif\", 4, \"ngIf\"], [\"for\", \"mailAddress\"], [\"type\", \"text\", \"id\", \"mailAddressInput\", \"formControlName\", \"mailAddress\"], [\"for\", \"firstName\"], [\"type\", \"text\", \"id\", \"firstNameInput\", \"formControlName\", \"firstName\"], [\"for\", \"lastName\"], [\"type\", \"text\", \"id\", \"lastNameInput\", \"formControlName\", \"lastName\"], [\"for\", \"birthDate\"], [\"type\", \"date\", \"id\", \"birthDateInput\", \"formControlName\", \"birthDate\"], [\"for\", \"location\"], [\"type\", \"text\", \"id\", \"locationInput\", \"formControlName\", \"location\"], [\"id\", \"genderMaleInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Homme\", \"checked\", \"\"], [\"for\", \"genderMale\"], [\"id\", \"genderFemaleInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Femme\"], [\"for\", \"genderFemale\"], [\"id\", \"genderOtherInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Autre\"], [\"for\", \"genderOther\"], [\"for\", \"instrument\"], [\"formControlName\", \"instrument\", \"id\", \"instrumentSelect\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"singerYesInput\", \"type\", \"radio\", \"name\", \"singer\", \"formControlName\", \"singer\", \"value\", \"yes\"], [\"for\", \"singerYes\"], [\"id\", \"singerNoInput\", \"type\", \"radio\", \"name\", \"singer\", \"formControlName\", \"singer\", \"value\", \"no\"], [\"for\", \"singerNo\"], [\"id\", \"proYesInput\", \"type\", \"radio\", \"name\", \"pro\", \"formControlName\", \"pro\", \"value\", \"yes\"], [\"for\", \"proYes\"], [\"id\", \"proNoInput\", \"type\", \"radio\", \"name\", \"pro\", \"formControlName\", \"pro\", \"value\", \"no\"], [\"for\", \"proNo\"], [\"name\", \"bio\", \"id\", \"bioInput\", \"formControlName\", \"bio\", \"cols\", \"30\", \"rows\", \"10\"], [\"type\", \"submit\", \"value\", \"Inscription !\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"submit\", \"value\", \"Enregistrer les modifications\", 3, \"click\", 4, \"ngIf\"], [\"for\", \"passwordModif\"], [\"type\", \"text\", \"id\", \"passwordModifInput\", \"formControlName\", \"passwordModif\"], [\"type\", \"file\", \"formControlName\", \"profilePicture\", 3, \"change\"], [\"alt\", \"\", 3, \"src\"], [3, \"value\"], [\"type\", \"submit\", \"value\", \"Inscription !\", 3, \"click\"], [\"type\", \"submit\", \"value\", \"Enregistrer les modifications\", 3, \"click\"]],\n    template: function EditProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, EditProfileComponent_h2_1_Template, 2, 0, \"h2\", 1);\n        i0.ɵɵtemplate(2, EditProfileComponent_h2_2_Template, 2, 0, \"h2\", 1);\n        i0.ɵɵelementStart(3, \"form\", 2)(4, \"label\", 3);\n        i0.ɵɵtext(5, \"Pseudo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"input\", 4)(7, \"br\")(8, \"br\");\n        i0.ɵɵelementStart(9, \"label\", 5);\n        i0.ɵɵtext(10, \"Mot de passe\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"input\", 6)(12, \"br\")(13, \"br\");\n        i0.ɵɵtemplate(14, EditProfileComponent_label_14_Template, 2, 0, \"label\", 7);\n        i0.ɵɵtemplate(15, EditProfileComponent_input_15_Template, 1, 0, \"input\", 8);\n        i0.ɵɵelement(16, \"br\")(17, \"br\");\n        i0.ɵɵelementStart(18, \"label\", 9);\n        i0.ɵɵtext(19, \"Adresse mail\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(20, \"input\", 10)(21, \"br\")(22, \"br\");\n        i0.ɵɵelementStart(23, \"label\", 11);\n        i0.ɵɵtext(24, \"Pr\\u00E9nom\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(25, \"input\", 12)(26, \"br\")(27, \"br\");\n        i0.ɵɵelementStart(28, \"label\", 13);\n        i0.ɵɵtext(29, \"Nom\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(30, \"input\", 14)(31, \"br\")(32, \"br\");\n        i0.ɵɵelementStart(33, \"label\", 15);\n        i0.ɵɵtext(34, \"Date de naissance\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(35, \"input\", 16)(36, \"br\")(37, \"br\");\n        i0.ɵɵelementStart(38, \"label\", 17);\n        i0.ɵɵtext(39, \"Ville\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(40, \"input\", 18)(41, \"br\");\n        i0.ɵɵtemplate(42, EditProfileComponent_div_42_Template, 5, 1, \"div\", 1);\n        i0.ɵɵelementStart(43, \"p\");\n        i0.ɵɵtext(44, \"Genre:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(45, \"input\", 19);\n        i0.ɵɵelementStart(46, \"label\", 20);\n        i0.ɵɵtext(47, \"Homme\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(48, \"input\", 21);\n        i0.ɵɵelementStart(49, \"label\", 22);\n        i0.ɵɵtext(50, \"Femme\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(51, \"input\", 23);\n        i0.ɵɵelementStart(52, \"label\", 24);\n        i0.ɵɵtext(53, \"Autre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(54, \"br\")(55, \"br\");\n        i0.ɵɵelementStart(56, \"p\");\n        i0.ɵɵtext(57, \"Dis nous en plus....\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(58, \"label\", 25);\n        i0.ɵɵtext(59, \"Instrument de pr\\u00E9dilection :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(60, \"select\", 26)(61, \"option\", 27);\n        i0.ɵɵtext(62, \"Choix...\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(63, EditProfileComponent_option_63_Template, 2, 2, \"option\", 28);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(64, \"p\");\n        i0.ɵɵtext(65, \"Tu chantes?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(66, \"input\", 29);\n        i0.ɵɵelementStart(67, \"label\", 30);\n        i0.ɵɵtext(68, \"Oui!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(69, \"input\", 31);\n        i0.ɵɵelementStart(70, \"label\", 32);\n        i0.ɵɵtext(71, \"Non\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(72, \"br\")(73, \"br\");\n        i0.ɵɵelementStart(74, \"p\");\n        i0.ɵɵtext(75, \"Tu es un pro?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(76, \"input\", 33);\n        i0.ɵɵelementStart(77, \"label\", 34);\n        i0.ɵɵtext(78, \"Oui\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(79, \"input\", 35);\n        i0.ɵɵelementStart(80, \"label\", 36);\n        i0.ɵɵtext(81, \"Non\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(82, \"br\")(83, \"br\");\n        i0.ɵɵelementStart(84, \"p\");\n        i0.ɵɵtext(85, \" Un petit mot sur ce que tu recherches ou proposes et qui sera affich\\u00E9 sur ton profil? \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(86, \"textarea\", 37)(87, \"br\")(88, \"br\");\n        i0.ɵɵtemplate(89, EditProfileComponent_input_89_Template, 1, 0, \"input\", 38);\n        i0.ɵɵtemplate(90, EditProfileComponent_input_90_Template, 1, 0, \"input\", 39);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.userProfileForm);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n        i0.ɵɵadvance(27);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"ngForOf\", ctx.instrumentsList);\n        i0.ɵɵadvance(26);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n      }\n    },\n    directives: [i7.NgIf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.DefaultValueAccessor, i3.NgControlStatus, i3.FormControlName, i3.RadioControlValueAccessor, i3.SelectControlValueAccessor, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i7.NgForOf],\n    styles: [\"img[_ngcontent-%COMP%]{width:200px}\"]\n  });\n  return EditProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}