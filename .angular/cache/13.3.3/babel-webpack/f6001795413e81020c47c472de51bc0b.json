{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { ageValidator } from 'src/shared/minimum-age.directive';\nimport { pictureValidator } from 'src/shared/picture-format.directive';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/services/auth.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../services/buddy.service\";\nimport * as i5 from \"src/services/image.service\";\nimport * as i6 from \"src/services/displaying-elements.service\";\nimport * as i7 from \"@angular/common\";\n\nfunction EditProfileComponent_h2_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"CREATION DU PROFIL\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_h2_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"EDITION DU PROFIL\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_input_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"input\", 40);\n  }\n}\n\nfunction EditProfileComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Photo de profil:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 41);\n    i0.ɵɵlistener(\"change\", function EditProfileComponent_div_43_Template_input_change_3_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.selectFile($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"img\", 42);\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6, \"Photo de banni\\u00E8re:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 43)(8, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", ctx_r3.previewProfilePic, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction EditProfileComponent_option_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 44);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const instrument_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", instrument_r9);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", instrument_r9, \" \");\n  }\n}\n\nfunction EditProfileComponent_input_90_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"input\", 45);\n    i0.ɵɵlistener(\"click\", function EditProfileComponent_input_90_Template_input_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.onSubmitProfileForm();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditProfileComponent_input_91_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"input\", 46);\n    i0.ɵɵlistener(\"click\", function EditProfileComponent_input_91_Template_input_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.onSubmitModifProfileForm();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let EditProfileComponent = /*#__PURE__*/(() => {\n  class EditProfileComponent {\n    // genericPattern: string = '^[^<].*[^>]$';\n    // passwordPattern: string =\n    //   '^[^<>](?=.{8,}$)(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*\\\\W).*[^<>]$';\n    constructor(router, authService, formBuilder, buddyService, imageservice, displayingElementsService) {\n      this.router = router;\n      this.authService = authService;\n      this.formBuilder = formBuilder;\n      this.buddyService = buddyService;\n      this.imageservice = imageservice;\n      this.displayingElementsService = displayingElementsService; // controlsFormList: string[] = [\n      //   'login',\n      //   'password',\n      //   'mailAddress',\n      //   'firstName',\n      //   'lastName',\n      //   'birthDate',\n      //   'location',\n      //   'gender',\n      //   'instrument',\n      //   'singer',\n      //   'pro',\n      //   'bio',\n      //   'profilePicture',\n      //   'bannerPicture',\n      // ];\n\n      this.instrumentsList = ['Aucun', 'Guitare', 'Basse', 'Ukulélé', 'Batterie', 'Cajun', 'Trompette', 'Synthé', 'piano', 'Flûte traversière'];\n    }\n\n    ngOnInit() {\n      this.displayingElementsService.displayingProfileCreationMode.subscribe(updateClassCrea => {\n        this.displayCreationMode = updateClassCrea;\n      });\n      console.log('displayCreationMode : ', this.displayCreationMode);\n      this.userProfileForm = this.formBuilder.group({\n        login: [null, {\n          validators: [Validators.required, Validators.minLength(3)]\n        }],\n        password: ['Blup1-1pulB', {\n          validators: [Validators.required, Validators.pattern(this.authService.passwordPattern)]\n        }],\n        passwordModif: ['', {\n          validators: [Validators.pattern(this.authService.passwordPattern)]\n        }],\n        mailAddress: ['@gmail.com', {\n          validators: [Validators.required, Validators.email]\n        }],\n        firstName: [null, {\n          validators: [Validators.required]\n        }],\n        lastName: [null, {\n          validators: [Validators.required]\n        }],\n        birthDate: ['', {\n          validators: [Validators.required, ageValidator(this.authService.minimumAge)]\n        }],\n        location: [null, {\n          validators: [Validators.required]\n        }],\n        gender: [null, Validators.required],\n        instrument: [null, Validators.required],\n        singer: [null, Validators.required],\n        pro: [null, Validators.required],\n        bio: [null],\n        profilePicture: [null, pictureValidator(this.authService.pictureExtension)],\n        bannerPicture: [null]\n      });\n      console.log('this.displayCreationMode : ', this.displayCreationMode);\n\n      if (!this.displayCreationMode) {\n        this.formFilling();\n      }\n    }\n\n    formFilling() {\n      this.buddyService.getMyInformations().subscribe(value => {\n        console.log('je suis : ', value);\n        this.userProfileForm.controls['login'].setValue(value['login']);\n        this.userProfileForm.controls['mailAddress'].setValue(value['mailAddress']);\n        this.userProfileForm.controls['firstName'].setValue(value['firstName']);\n        this.userProfileForm.controls['lastName'].setValue(value['lastName']);\n        this.userProfileForm.controls['birthDate'].setValue(value['birthDate']);\n        this.userProfileForm.controls['location'].setValue(value['location']);\n        this.userProfileForm.controls['gender'].setValue(value['gender']);\n        this.userProfileForm.controls['instrument'].setValue(value['instrument']);\n        this.userProfileForm.controls['singer'].setValue(value['singer']);\n        this.userProfileForm.controls['pro'].setValue(value['pro']);\n        this.userProfileForm.controls['bio'].setValue(value['bio']);\n      });\n    }\n\n    selectFile(event) {\n      const file = event.target.files[0];\n      this.imageservice.getBase64(file).subscribe(str => {\n        this.previewProfilePic = str;\n      });\n    }\n\n    onSubmitProfileForm() {\n      this.userProfileForm.value.profilePicture = this.previewProfilePic;\n      console.log('soumission du formulaire: ', this.userProfileForm);\n      this.authService.authUser(this.userProfileForm, '/register');\n    }\n\n    onSubmitModifProfileForm() {\n      if (this.userProfileForm.value.password === '') {\n        delete this.userProfileForm.value.password;\n      }\n\n      console.log('modification du formulaire: ', this.userProfileForm);\n      this.authService.updatehUser(this.userProfileForm, '/updateprofile');\n      this.router.navigateByUrl('/blankprofile');\n    }\n\n  }\n\n  EditProfileComponent.ɵfac = function EditProfileComponent_Factory(t) {\n    return new (t || EditProfileComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.BuddyService), i0.ɵɵdirectiveInject(i5.ImageService), i0.ɵɵdirectiveInject(i6.DisplayingElementsService));\n  };\n\n  EditProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditProfileComponent,\n    selectors: [[\"app-edit-profile\"]],\n    decls: 92,\n    vars: 8,\n    consts: [[1, \"form-card\"], [4, \"ngIf\"], [3, \"formGroup\"], [\"for\", \"login\"], [\"type\", \"text\", \"id\", \"loginInput\", \"formControlName\", \"login\"], [\"for\", \"password\"], [\"type\", \"text\", \"id\", \"passwordInput\", \"formControlName\", \"password\"], [\"for\", \"passwordModif\"], [\"type\", \"text\", \"id\", \"passwordModifInput\", \"formControlName\", \"passwordModif\", 4, \"ngIf\"], [\"for\", \"mailAddress\"], [\"type\", \"text\", \"id\", \"mailAddressInput\", \"formControlName\", \"mailAddress\"], [\"for\", \"firstName\"], [\"type\", \"text\", \"id\", \"firstNameInput\", \"formControlName\", \"firstName\"], [\"for\", \"lastName\"], [\"type\", \"text\", \"id\", \"lastNameInput\", \"formControlName\", \"lastName\"], [\"for\", \"birthDate\"], [\"type\", \"date\", \"id\", \"birthDateInput\", \"formControlName\", \"birthDate\"], [\"for\", \"location\"], [\"type\", \"text\", \"id\", \"locationInput\", \"formControlName\", \"location\"], [\"id\", \"genderMaleInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Homme\", \"checked\", \"\"], [\"for\", \"genderMale\"], [\"id\", \"genderFemaleInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Femme\"], [\"for\", \"genderFemale\"], [\"id\", \"genderOtherInput\", \"type\", \"radio\", \"name\", \"gender\", \"formControlName\", \"gender\", \"value\", \"Autre\"], [\"for\", \"genderOther\"], [\"for\", \"instrument\"], [\"formControlName\", \"instrument\", \"id\", \"instrumentSelect\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"singerYesInput\", \"type\", \"radio\", \"name\", \"singer\", \"formControlName\", \"singer\", \"value\", \"yes\"], [\"for\", \"singerYes\"], [\"id\", \"singerNoInput\", \"type\", \"radio\", \"name\", \"singer\", \"formControlName\", \"singer\", \"value\", \"no\"], [\"for\", \"singerNo\"], [\"id\", \"proYesInput\", \"type\", \"radio\", \"name\", \"pro\", \"formControlName\", \"pro\", \"value\", \"yes\"], [\"for\", \"proYes\"], [\"id\", \"proNoInput\", \"type\", \"radio\", \"name\", \"pro\", \"formControlName\", \"pro\", \"value\", \"no\"], [\"for\", \"proNo\"], [\"name\", \"bio\", \"id\", \"bioInput\", \"formControlName\", \"bio\", \"cols\", \"30\", \"rows\", \"10\"], [\"type\", \"submit\", \"value\", \"Inscription !\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"submit\", \"value\", \"Enregistrer les modifications\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"text\", \"id\", \"passwordModifInput\", \"formControlName\", \"passwordModif\"], [\"type\", \"file\", \"formControlName\", \"profilePicture\", 3, \"change\"], [\"alt\", \"\", 3, \"src\"], [\"type\", \"file\", \"formControlName\", \"bannerPicture\"], [3, \"value\"], [\"type\", \"submit\", \"value\", \"Inscription !\", 3, \"click\"], [\"type\", \"submit\", \"value\", \"Enregistrer les modifications\", 3, \"click\"]],\n    template: function EditProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, EditProfileComponent_h2_1_Template, 2, 0, \"h2\", 1);\n        i0.ɵɵtemplate(2, EditProfileComponent_h2_2_Template, 2, 0, \"h2\", 1);\n        i0.ɵɵelementStart(3, \"form\", 2)(4, \"label\", 3);\n        i0.ɵɵtext(5, \"Pseudo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"input\", 4)(7, \"br\")(8, \"br\");\n        i0.ɵɵelementStart(9, \"label\", 5);\n        i0.ɵɵtext(10, \"Mot de passe\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"input\", 6)(12, \"br\")(13, \"br\");\n        i0.ɵɵelementStart(14, \"label\", 7);\n        i0.ɵɵtext(15, \"Nouveau mot de passe\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(16, EditProfileComponent_input_16_Template, 1, 0, \"input\", 8);\n        i0.ɵɵelement(17, \"br\")(18, \"br\");\n        i0.ɵɵelementStart(19, \"label\", 9);\n        i0.ɵɵtext(20, \"Adresse mail\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"input\", 10)(22, \"br\")(23, \"br\");\n        i0.ɵɵelementStart(24, \"label\", 11);\n        i0.ɵɵtext(25, \"Pr\\u00E9nom\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(26, \"input\", 12)(27, \"br\")(28, \"br\");\n        i0.ɵɵelementStart(29, \"label\", 13);\n        i0.ɵɵtext(30, \"Nom\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(31, \"input\", 14)(32, \"br\")(33, \"br\");\n        i0.ɵɵelementStart(34, \"label\", 15);\n        i0.ɵɵtext(35, \"Date de naissance\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(36, \"input\", 16)(37, \"br\")(38, \"br\");\n        i0.ɵɵelementStart(39, \"label\", 17);\n        i0.ɵɵtext(40, \"Ville\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(41, \"input\", 18)(42, \"br\");\n        i0.ɵɵtemplate(43, EditProfileComponent_div_43_Template, 9, 1, \"div\", 1);\n        i0.ɵɵelementStart(44, \"p\");\n        i0.ɵɵtext(45, \"Genre:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(46, \"input\", 19);\n        i0.ɵɵelementStart(47, \"label\", 20);\n        i0.ɵɵtext(48, \"Homme\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(49, \"input\", 21);\n        i0.ɵɵelementStart(50, \"label\", 22);\n        i0.ɵɵtext(51, \"Femme\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(52, \"input\", 23);\n        i0.ɵɵelementStart(53, \"label\", 24);\n        i0.ɵɵtext(54, \"Autre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(55, \"br\")(56, \"br\");\n        i0.ɵɵelementStart(57, \"p\");\n        i0.ɵɵtext(58, \"Dis nous en plus....\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(59, \"label\", 25);\n        i0.ɵɵtext(60, \"Instrument de pr\\u00E9dilection :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(61, \"select\", 26)(62, \"option\", 27);\n        i0.ɵɵtext(63, \"Choix...\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(64, EditProfileComponent_option_64_Template, 2, 2, \"option\", 28);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(65, \"p\");\n        i0.ɵɵtext(66, \"Tu chantes?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(67, \"input\", 29);\n        i0.ɵɵelementStart(68, \"label\", 30);\n        i0.ɵɵtext(69, \"Oui!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(70, \"input\", 31);\n        i0.ɵɵelementStart(71, \"label\", 32);\n        i0.ɵɵtext(72, \"Non\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(73, \"br\")(74, \"br\");\n        i0.ɵɵelementStart(75, \"p\");\n        i0.ɵɵtext(76, \"Tu es un pro?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(77, \"input\", 33);\n        i0.ɵɵelementStart(78, \"label\", 34);\n        i0.ɵɵtext(79, \"Oui\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(80, \"input\", 35);\n        i0.ɵɵelementStart(81, \"label\", 36);\n        i0.ɵɵtext(82, \"Non\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(83, \"br\")(84, \"br\");\n        i0.ɵɵelementStart(85, \"p\");\n        i0.ɵɵtext(86, \" Un petit mot sur ce que tu recherches ou proposes et qui sera affich\\u00E9 sur ton profil? \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(87, \"textarea\", 37)(88, \"br\")(89, \"br\");\n        i0.ɵɵtemplate(90, EditProfileComponent_input_90_Template, 1, 0, \"input\", 38);\n        i0.ɵɵtemplate(91, EditProfileComponent_input_91_Template, 1, 0, \"input\", 39);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.userProfileForm);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n        i0.ɵɵadvance(27);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"ngForOf\", ctx.instrumentsList);\n        i0.ɵɵadvance(26);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayCreationMode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.displayCreationMode);\n      }\n    },\n    directives: [i7.NgIf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.DefaultValueAccessor, i3.NgControlStatus, i3.FormControlName, i3.RadioControlValueAccessor, i3.SelectControlValueAccessor, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i7.NgForOf],\n    styles: [\"img[_ngcontent-%COMP%]{width:200px}\"]\n  });\n  return EditProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}